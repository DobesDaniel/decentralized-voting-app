(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(e,t,n){e.exports=n(18)},,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(4),l=n.n(i),c=(n(13),n(1)),r=n.n(c);n(14);var s="0xe030B8C9EB37eD54b79AB8E235Bff7b347C38280";var u=[{inputs:[{internalType:"string",name:"_title",type:"string"},{internalType:"string[]",name:"_optionTitles",type:"string[]"},{internalType:"uint256",name:"_start",type:"uint256"},{internalType:"uint256",name:"_timeLimit",type:"uint256"}],name:"createVoting",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getOptions",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"title",type:"string"},{internalType:"uint256",name:"vote_count",type:"uint256"}],internalType:"struct VotingContract.Option[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_voting_id",type:"uint256"}],name:"getVotingOptions",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"title",type:"string"},{internalType:"uint256",name:"vote_count",type:"uint256"}],internalType:"struct VotingContract.Option[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVotings",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"title",type:"string"},{internalType:"uint256",name:"start",type:"uint256"},{internalType:"uint256",name:"timeLimit",type:"uint256"},{internalType:"uint256[]",name:"option_ids",type:"uint256[]"},{internalType:"address[]",name:"voted_addresses",type:"address[]"}],internalType:"struct VotingContract.Voting[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_voting_id",type:"uint256"}],name:"hasEnded",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_voting_id",type:"uint256"}],name:"hasStarted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_voting_id",type:"uint256"},{internalType:"address",name:"voting_address",type:"address"}],name:"hasVoted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_voting_id",type:"uint256"},{internalType:"uint256",name:"_option_id",type:"uint256"}],name:"vote",outputs:[],stateMutability:"nonpayable",type:"function"}];n(15),n(16);var m=function(e){let{onCancel:t,connectedAccount:n}=e;const[i,l]=Object(a.useState)(""),[c,m]=Object(a.useState)(""),[d,p]=Object(a.useState)(""),[y,v]=Object(a.useState)([]),[g,w]=Object(a.useState)("");let f;return Object(a.useEffect)(()=>{!async function(){window.ethereum?f=new r.a(window.ethereum):console.error("Please install MetaMask")}()},[]),o.a.createElement("div",{className:"new-voting-form"},o.a.createElement("h1",null,"Create New Voting"),o.a.createElement("div",null,o.a.createElement("label",null,"Title:"),o.a.createElement("input",{type:"text",value:i,onChange:e=>l(e.target.value)})),o.a.createElement("div",null,o.a.createElement("label",null,"Start Time:"),o.a.createElement("input",{type:"datetime-local",value:c,onChange:e=>m(e.target.value)})),o.a.createElement("div",null,o.a.createElement("label",null,"End Time:"),o.a.createElement("input",{type:"datetime-local",value:d,onChange:e=>p(e.target.value)})),o.a.createElement("div",null,o.a.createElement("label",null,"Options:"),o.a.createElement("div",{className:"options-container"},y.map((e,t)=>o.a.createElement("div",{key:t,className:"option-block remove-option",onClick:()=>(e=>{const t=[...y];t.splice(e,1),v(t)})(t)},o.a.createElement("div",{className:"option-title"},e),"remove")),o.a.createElement("div",{className:"option-block add-option",onClick:()=>{""!==g.trim()&&(v([...y,g.trim()]),w(""))}},o.a.createElement("input",{type:"text",value:g,onChange:e=>w(e.target.value)}),"add"))),o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{onClick:t},"Back"),o.a.createElement("button",{onClick:async function(){if(f||(window.ethereum?f=new r.a(window.ethereum):console.error("Please install MetaMask")),!i.trim())return void console.error("Title cannot be empty");if(!c)return void console.error("Start time must be selected");if(!d)return void console.error("End time must be selected");if(new Date(c)>=new Date(d))return void console.error("Start time must be before end time");if(new Date(c)<=new Date)return void console.error("Start time must be in the future");if(y.length<2)return void console.error("At least two options are required");if(new Set(y.map(e=>e.trim().toLowerCase())).size!==y.length)return void console.error("Options must be unique");const e=Math.floor(new Date(c).getTime()/1e3),a=Math.floor(new Date(d).getTime()/1e3)-e,o=new f.eth.Contract(u,s);try{await o.methods.createVoting(i,y,e,a).send({from:n}),t()}catch(l){console.error("Error voting:",l)}}},"Create")))};var d=function(e){let{votings:t,onSelectVoting:n,reloadVotings:i,connectedAccount:l}=e;const[c,r]=Object(a.useState)(null),[s,u]=Object(a.useState)(!1),[d,p]=Object(a.useState)(null),[y,v]=Object(a.useState)(null);function g(e){const t=Math.floor(Date.now()/1e3),n=Number(e.start),a=n+Number(e.timeLimit);if(t<n){const e=n-t,a=Math.floor(e/86400),o=Math.floor(e%86400/3600),i=Math.floor(e%3600/60),l=e%60;return"Voting starts in ".concat(a,"d ").concat(o,"h ").concat(i,"m ").concat(l,"s")}if(t<a){const e=a-t,n=Math.floor(e/86400),o=Math.floor(e%86400/3600),i=Math.floor(e%3600/60),l=e%60;return"Voting ends in ".concat(n,"d ").concat(o,"h ").concat(i,"m ").concat(l,"s")}return"Voting ended"}return Object(a.useEffect)(()=>{if(c){p(g(c));const e=setInterval(()=>{p(g(c))},1e3);v(e)}},[c]),Object(a.useEffect)(()=>()=>{clearInterval(y)},[y]),o.a.createElement("div",null,s?o.a.createElement(m,{onCancel:()=>(i(),void u(!1)),connectedAccount:l}):o.a.createElement("div",{className:"vtoing-grid-wrapper"},o.a.createElement("div",{className:"voting-grid"},t.map(e=>o.a.createElement("div",{key:e.id,className:"voting-block",onClick:()=>n(e),onMouseEnter:()=>{r(e)},onMouseLeave:()=>{r(null),p(null)}},c&&e.id===c.id?o.a.createElement("div",{className:"time-left"},d):o.a.createElement("h3",null,e.title))),o.a.createElement("div",{className:"voting-block create-new",onClick:()=>{u(!0)}},o.a.createElement("div",{className:"add-voting"},"+")))))};n(17);var p=function(e){let{voting:t,onBack:n,connectedAccount:i}=e;const[l,c]=Object(a.useState)([]),[m,d]=Object(a.useState)(null),[p,y]=Object(a.useState)(!1),[v,g]=Object(a.useState)(!1),[w,f]=Object(a.useState)(!1);let b;const h=60;function E(e){const t=new Date(1e3*e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}return Object(a.useEffect)(()=>{!async function(){window.ethereum?b=new r.a(window.ethereum):console.error("Please install MetaMask")}()},[]),Object(a.useEffect)(()=>{async function e(){b||(window.ethereum?b=new r.a(window.ethereum):console.error("Please install MetaMask"));const e=new b.eth.Contract(u,s),n=await e.methods.hasStarted(t.id).call();g(n);const a=await e.methods.hasEnded(t.id).call();f(a);const o=await e.methods.hasVoted(t.id,i).call({from:i});if(y(o),n){const n=await e.methods.getVotingOptions(t.id).call();c(n)}}e(),async function(){const n=Math.floor(Date.now()/1e3),a=Number(t.start)-n+h;a<=0?e():setTimeout(()=>{e()},1e3*a)}(),async function(){const n=Math.floor(Date.now()/1e3),a=Number(t.start)+Number(t.timeLimit)-n+h;a<=0?e():setTimeout(()=>{e()},1e3*a)}()},[]),o.a.createElement("div",{className:"voting-detail"},!w&&v&&o.a.createElement("h1",null,"Ongoing voting"),!v&&o.a.createElement("h1",null,"Voting has not started yet"),w&&o.a.createElement("h1",null,"Voting Ended"),o.a.createElement("h2",null,t.title),o.a.createElement("p",null,"Start Time: ",E(Number(t.start))),o.a.createElement("p",null,"End Time: ",E(Number(t.start)+Number(t.timeLimit))),o.a.createElement("h3",null,"Options:"),v&&o.a.createElement("div",{className:"options-container"},l.map(e=>o.a.createElement("div",{key:e.id,className:"option-block only-title ".concat(m===e.id?"selected":""),onClick:()=>d(e.id)},o.a.createElement("div",{className:"option-title"},e.title),(w||p)&&o.a.createElement("div",{className:"vote-count"},"Votes: ",String(e.vote_count))))),o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{onClick:n},"Back"),!w&&!p&&v&&o.a.createElement("button",{onClick:async function(){if(b||(window.ethereum?b=new r.a(window.ethereum):console.error("Please install MetaMask")),!m)return void console.error("Please select an option.");const e=new b.eth.Contract(u,s);try{await e.methods.vote(t.id,m).send({from:i}),y(!0)}catch(n){console.error("Error voting:",n)}}},"Vote")))};var y=function(){const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)([]),[l,c]=Object(a.useState)(null);let m;return Object(a.useEffect)(()=>{!async function(){if(window.ethereum){m=new r.a(window.ethereum);try{await window.ethereum.request({method:"eth_requestAccounts"});const n=await m.eth.getAccounts();t(n[0])}catch(e){console.error("User denied account access")}}else console.error("Please install MetaMask")}()},[]),Object(a.useEffect)(()=>{!async function(){if(m){const e=new m.eth.Contract(u,s),t=await e.methods.getVotings().call();i(t)}}()},[m]),o.a.createElement("div",null,o.a.createElement("div",{className:"connected-account"},"Connected Account: ",e),l?o.a.createElement(p,{voting:l,onBack:()=>c(null),connectedAccount:e}):o.a.createElement(d,{votings:n,onSelectVoting:e=>c(e),selectedVoting:l,reloadVotings:async function(){m||(window.ethereum?m=new r.a(window.ethereum):console.error("Please install MetaMask"));const e=new m.eth.Contract(u,s),t=await e.methods.getVotings().call();i(t)},connectedAccount:e}))};var v=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,19)).then(t=>{let{getCLS:n,getFID:a,getFCP:o,getLCP:i,getTTFB:l}=t;n(e),a(e),o(e),i(e),l(e)})};l.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(y,null))),v()}],[[5,1,2]]]);
//# sourceMappingURL=main.04ca9293.chunk.js.map